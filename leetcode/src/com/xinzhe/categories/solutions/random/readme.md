## 等概率映射

### Solutions
#### rand 大数生成小数
    缩小范围，等概率映射，映射不到的就继续调用

#### rand 小数生成大数
    放大范围，确保每个值等概率出现。

### Explain
#### 从 rand2() 到 rand4()
    rand2() -> [1,2]  //rand2()可以均匀的生成[1,2]的随机数
    现在想等概率的生成[1,4]的随机数：
    rand2() + rand2()   = ? => [2, 4]
    1       +   1       = 2
    1       +   2       = 3
    2       +   1       = 3
    2       +   2       = 4
    
    // 为了把生成随机数的范围规约成[1,n]，于是在上一步的结果后减1
    (rand2()-1)*2   + rand2()   = ? => [2, 4]
    0               +   1       = 1
    0               +   2       = 2
    2               +   1       = 3
    2               +   2       = 4

#### 从 rand4() 到 rand2()
    rand4() -> [1,4]  //rand4()可以均匀的生成[1,4]的随机数
    rand4() % 2 + 1 = ?  //取余，加1
       1 % 2    + 1 = 2
       2 % 2    + 1 = 1
       3 % 2    + 1 = 2
       4 % 2    + 1 = 1
    rand_N()中N是2的倍数，就都可以用来实现rand2()

### Example 
#### 从 rand7() 到 rand10()
    (rand7()-1) × 7 + rand7()  ==> rand49()
##### 拒绝采样
    弃掉[41, 49]这9个数
```
public int rand10() {
    while(true) {
        int num = (rand7() - 1) * 7 + rand7(); // 等概率生成[1,49]范围的随机数
        if(num <= 40) return num % 10 + 1; // 拒绝采样，并返回[1,10]范围的随机数
    }
}
```
##### 拒绝采样的优化
    对于[41, 49]利用这9个数，：
    
    (num - 40 - 1) * 7 + rand7() | num > 40
    
    得到 [1, 63] 之间的随机数，只要舍弃 3 个即可，那对于这 3 个舍弃的，还可以再来一轮：
    
    (num - 60 - 1) * 7 + rand7() | num > 60
    
    可得 [1, 21] 之间的随机数，只要舍弃 1 个即可。
```java
class Solution extends SolBase {
    public int rand10() {
        while (true){
            int num = (rand7() - 1) * 7 + rand7();
            // 如果在40以内，那就直接返回
            if(num <= 40) return 1 + num % 10;
            // 说明刚才生成的在41-49之间，利用随机数再操作一遍
            num = (num - 40 - 1) * 7 + rand7();
            if(num <= 60) return 1 + num % 10;
            // 说明刚才生成的在61-63之间，利用随机数再操作一遍
            num = (num - 60 - 1) * 7 + rand7();
            if(num <= 20) return 1 + num % 10;

        }
    }
}
```
   
#### 从 rand10() 到 rand7()
    只要不断调用 rand10()
    如果第一次就 rand 到 1～7 之间的数，那就是直接命中了，概率为1/10
    如果第二次命中,那么第一次必定没命中，没命中的概率为 3/10 * 1/10
    ...
    
```
public int rand7() {
    int num = rand10(); 
    if(num <= 7) return num; 
    while(true) {
        num = rand10(); 
        if(num <= 7) return num; 
    }
}
```​
